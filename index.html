<!doctype html>
<html>

<head>
  <!-- <meta charset="utf-8">
  <title>DC Slot Machine</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content=""> -->


  <!-- <link rel="apple-touch-icon" href="icon.png"> -->

  <link rel="stylesheet" href="./global-styles.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>

</head>

<body>

  <section id="page15945-band137894" class="band sc-crrszt bvIsgC lfe-hero-band-parent">
    <div class="my-0 py-0 px-0 container lfe-hero-band">
      <div class="sc-dQoVA fAgxVF layout row d-flex">
        <div
          class="d-flex flex-column col-md-12 align-items-center justify-content-center my-md-5 pt-md-3 sc-hBEYId enKwoT">
          <div class="sc-bdfBQB kzMRIe img-wrapper-override initial-img-wrapper">
            <img id="page15945-band137894-Image137895" alt="HBO Max" class="img img-fluid lozad sc-bdfBQB kzMRIe"
              sizes="(max-width: 575px) 100vw, (min-width: 576px) and (max-width: 1024px) 100vw, (min-width: 1025px) 100vw, 100vw"
              data-src="https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=480"
              data-srcset="https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=480 480w, https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=960 960w, https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=1040 1040w"
              src="https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=480"
              srcset="https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=480 480w, https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=960 960w, https://hbomax-images.warnermediacdn.com/2021-05/hbo-max-ctr.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=1040 1040w"
              data-loaded="true" width="1040" height="168">
          </div>
          <div class="sc-jrAFXE dAUKNh text rich-text w-100 w-100" id="page15945-band137894-Text137896">
            <div class="text-center">
              <h3>The Streaming Home of DC. Watch Select Episodes for Free.</h3>
            </div>
          </div>
          <div id="page15945-band137894-Code137897" class="rich-text">

            <div class="lfe">

              <div class="lfe-slot-machine">

                <div id="dc-slots" class="slot-machine__slots slot-machine__slots--rolling">

                  <!-- og -->



                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GXxitAAda0DFAlwEAAAGH"
                    class="slot-machine__slot" style="transform: translate3d(301.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2021-08/harleyquinn_2019_1043255_tileburnedin_3000x3000_1.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Harley Quinn">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Harley Quinn</p>
                      <p class="title-content se">Season 1 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GX3UxFQN1mijDDgEAAAMU"
                    class="slot-machine__slot" style="transform: translate3d(426.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2020-12/ka_titans.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Titans">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Titans</p>
                      <p class="title-content se">Season 1 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GXsMtpwEDom2nwwEAAAAW"
                    class="slot-machine__slot" style="transform: translate3d(551.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2021-02/doompatrol_2020_2224684_tileburnedin_3000x3000.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Doom Patrol">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Doom Patrol</p>
                      <p class="title-content se">Season 2 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GXn6N3wBoI4BKRwEAAAO6"
                    class="slot-machine__slot" style="transform: translate3d(676.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2020-05/batwoman.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Batwoman">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Batwoman</p>
                      <p class="title-content se">Season 1 Episode 1</p>
                    </div>
                  </a>
                  <!-- og -->

                  <!-- clones -->
                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GX3UxFQN1mijDDgEAAAMU"
                    class="slot-machine__slot" style="transform: translate3d(801.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2020-12/ka_titans.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Titans">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Titans</p>
                      <p class="title-content se">Season 1 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GXsMtpwEDom2nwwEAAAAW"
                    class="slot-machine__slot" style="transform: translate3d(926.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2021-02/doompatrol_2020_2224684_tileburnedin_3000x3000.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Doom Patrol">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Doom Patrol</p>
                      <p class="title-content se">Season 2 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GXxitAAda0DFAlwEAAAGH"
                    class="slot-machine__slot" style="transform: translate3d(1051.88px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2021-08/harleyquinn_2019_1043255_tileburnedin_3000x3000_1.png?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Harley Quinn">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Harley Quinn</p>
                      <p class="title-content se">Season 1 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GXn6N3wBoI4BKRwEAAAO6"
                    class="slot-machine__slot" style="transform: translate3d(1176.88px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2020-05/batwoman.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Batwoman">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Batwoman</p>
                      <p class="title-content se">Season 1 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GX3UxFQN1mijDDgEAAAMU"
                    class="slot-machine__slot" style="transform: translate3d(51.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2020-12/ka_titans.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Titans">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Titans</p>
                      <p class="title-content se">Season 1 Episode 1</p>
                    </div>
                  </a>

                  <a href="https://play.hbomax.com/episode/urn:hbo:episode:GXsMtpwEDom2nwwEAAAAW"
                    class="slot-machine__slot" style="transform: translate3d(176.875px, 0px, 0px);">
                    <div class="slot__card">
                      <span class="play-btn"><span></span></span>
                      <img
                        src="https://hbomax-images.warnermediacdn.com/2021-02/doompatrol_2020_2224684_tileburnedin_3000x3000.jpg?host=wme-hbomax-drupal-prod.s3.amazonaws.com&amp;w=350"
                        alt="Doom Patrol">
                    </div>
                    <div class="slot__content">
                      <p class="free-content">Your Free Episode Is:</p>
                      <p class="title-content">Doom Patrol</p>
                      <p class="title-content se">Season 2 Episode 1</p>
                    </div>
                  </a>
                  <!-- clones -->

                </div>

                <div class="slot-machine__actions">
                  <span id="slot-machine__handle" class="lfe-button btn px-4 rounded-pill btn--primary btn-lg">
                    See What's Free
                  </span>

                  <span id="slot-machine__reset" class="lfe-button btn px-4 rounded-pill btn--primary btn-lg">
                    Spin Again
                  </span>
                </div>

              </div>

            </div>



          </div>
        </div>
      </div>
    </div>
  </section>


  
  <script type="text/javascript">
    (function () {

      let prevSlotSize = null;
      window.onresize = function () {
        let slotSize =
          (window.innerWidth >= 1200) ? 350 : (window.innerWidth < 1200 && window.innerWidth >= 768) ?
          250 : 125;
        console.log('slotSize', slotSize);

        if (prevSlotSize === null) {
          prevSlotSize = slotSize
        }

        if (slotSize != prevSlotSize) {

          rollingTL.clear();

          buildRollingTimeLine(slotSize);

          slotHandle.removeEventListener('click', () => {
            doTheStop(slotSize);
          });
          slotHandle.addEventListener('click', () => {
            doTheStop(slotSize);
          });

          prevSlotSize = slotSize

        }

      };

      // window.onload = function(){

      let slotSize =
        (window.innerWidth >= 1200) ? 350 : (window.innerWidth < 1200 && window.innerWidth >= 768) ? 250 :
        125;
      console.log('slotSize', slotSize);

      let isStopping = false;
      const theSlots = document.getElementById("dc-slots");
      const slots = theSlots.children;
      const slotHandle = document.getElementById("slot-machine__handle");
      const resetHandle = document.getElementById("slot-machine__reset");
      const rollingTL = new gsap.timeline({
        yoyo: false,
        paused: true,
        repeat: -1,
        defaults: {
          duration: 14,
          ease: "linear"
        },
        onStart: onStart()
      });

      buildRollingTimeLine(slotSize);

      const stoppingTL = new gsap.timeline({
        yoyo: false,
        paused: true,
        repeat: 0,
        defaults: {
          duration: 1,
          ease: "power4.inOut"
        },
        onReverseComplete: () => {
          onReverseComplete()
        }
      });

      setTimeout(function () {
        rollingTL.play();
      }, 1000);

      // theSlots.addEventListener('mouseenter', () => {
      //   if(!isStopping){rollingTL.timeScale(1.6);}
      // });
      //
      // theSlots.addEventListener('mouseleave', () => {
      //   if(!isStopping){rollingTL.timeScale(1);}
      // });

      slotHandle.addEventListener('mouseenter', () => {
        if (!isStopping) {
          rollingTL.timeScale(0.8);
        }
      });

      slotHandle.addEventListener('mouseleave', () => {
        if (!isStopping) {
          rollingTL.timeScale(1);
        }
      });

      slotHandle.addEventListener('click', () => {
        doTheStop(slotSize);
      });

      resetHandle.addEventListener('click', () => {
        doTheStart();
      });

      function doTheStart() {
        stoppingTL.reverse();
        let arrayOfSlots = [].slice.call(slots);
        console.log('arrayOfSlots', arrayOfSlots);
        arrayOfSlots.map(slot => slot.classList.remove("slot-machine__slot--inactive",
          "slot-machine__slot--active"));
      }

      function doTheStop(slotSize) {
        if (rollingTL.isActive()) {

          isStopping = true;

          rollingTL.timeScale(0.8);
          setTimeout(function () {
            rollingTL.timeScale(0.6);
          }, 400);
          setTimeout(function () {
            rollingTL.timeScale(0.4);
          }, 400 * 2);
          setTimeout(function () {
            rollingTL.timeScale(0.2);
          }, 400 * 3);
          setTimeout(function () {
            rollingTL.timeScale(0.1);
          }, 400 * 4);
          setTimeout(function () {
            rollingTL.pause();
            isStopping = false;
            onStop(slotSize);
          }, 400 * 5);

        }
        // else {
        //   rollingTL.timeScale(1);
        //   rollingTL.play();
        //   onStart();
        //
        // }
      }

      function onReverseComplete() {

        rollingTL.timeScale(1);
        rollingTL.play();
        onStart();
      }

      function onStart() {
        theSlots.classList.add('slot-machine__slots--rolling');
        theSlots.classList.remove('slot-machine__slots--stopped');
      }

      function onStop(slotSize) {

        let arrayOfSlots = [].slice.call(slots);
        console.log('arrayOfSlots', arrayOfSlots); // get each slot
        let xPosOfSlots = arrayOfSlots.map(slot => gsap.getProperty(slot, "x"));
        console.log('xPosOfSlots', xPosOfSlots); //  get the X pos of each slot
        let goal = (window.innerWidth / 2) +
        slotSize; // ~center of screen~ screen-width/2 + card-width-offset

        let closestNumToCenter = xPosOfSlots.reduce(function (prev, curr) {
          return (Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev);
        });
        console.log('closestNumToCenter', closestNumToCenter);

        let winningSlot = arrayOfSlots.find(slot => gsap.getProperty(slot, "x") === closestNumToCenter);
        console.log('winningSlot', winningSlot);

        arrayOfSlots.map(slot => slot.classList.remove("slot-machine__slot--inactive",
          "slot-machine__slot--active"));
        arrayOfSlots.map(slot => slot.classList.add("slot-machine__slot--inactive"));

        winningSlot.classList.remove("slot-machine__slot--inactive")
        winningSlot.classList.add("slot-machine__slot--active");

        theSlots.classList.add('slot-machine__slots--stopped');
        theSlots.classList.remove('slot-machine__slots--rolling');

        stoppingTL.clear();
        buildStoppingTimeLine(slotSize);
        stoppingTL.play();

      }

      function buildRollingTimeLine(slotSize) {
        gsap.set(".slot-machine__slot", {
          x: (i) => (i * slotSize)
        }).then(
          () => {
            rollingTL
              .from(".slot-machine__slot", {
                x: "+=" + (slotSize * 10),
                modifiers: {
                  x: gsap.utils.unitize(x => parseFloat(x) % (slotSize *
                    10)) //force x value to be between 0 and 2800 using modulus
                }
              });
          }
        );
      }

      function buildStoppingTimeLine(slotSize) {

        stoppingTL
          .set(".slot-machine__slot--active", {
            zIndex: 1
          })
          .set(".slot-machine__slot--active .slot__card .play-btn", {
            scale: 0.4
          })
          .to(".slot-machine__slot--inactive", {
            autoAlpha: 0.1
          }, 0)
          .to(".slot-machine__slot--active", {
            backgroundColor: 'rgba(0,0,0,0.4)',
            boxShadow: '0 0 .1em rgba(255,255,255,1),0 0 .2em 2px rgba(185, 8, 246, 1),0 0 2em rgba(185, 8, 246, 1),0 0 0.8em rgba(185, 8, 246, 1),0 0 2.8em rgba(185, 8, 246, 1),inset 0 0 .1em rgba(255,255,255,1),inset 0 0 .2em 2px rgba(185, 8, 246, 1),inset 0 0 1.3em rgba(185, 8, 246, 1)',
            border: '2px solid white',
            width: (slotSize * 2),
          }, 0.4)
          .to(slotHandle, {
            autoAlpha: 0,
            y: '-40',
          }, "<")
          .to(".slot-machine__slot--active .slot__card .play-btn", {
            scale: 1,
            autoAlpha: 1,
          }, "<")
          .to(".slot-machine__slot--active .slot__content", {
            autoAlpha: 1,
            x: slotSize,
          }, "<")
          .to(resetHandle, {
            autoAlpha: 1,
            y: '-60'
          }, "<1");

      }

      // };

    })();
  </script>
</body>

</html>